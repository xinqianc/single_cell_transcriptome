Sequencing dataset: GSE73727 (Gene Expression Omnibus, GEO)
Click SRA RUN Selector in the supplementary file (There are 70 samples [70 cells]), download 6 samples by using "fastq-dump" one by one.
SRR2558121   beta
SRR2558138   beta
SRR2558146   alpha	
SRR2558143   alpha
SRR2558142   alpha
SRR2558140   beta

(1)Download SRA toolkit environment: 
(base) [xinqianc@colossus long_term_project]$ wget http://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/current (https://ncbi.github.io/sra-tools/install_config.html) 
(base) [xinqianc@colossus long_term_project]$tar -xzf sratoolkit.current-centos_linux64.tar.gz (unpacking tar file)
(base) [xinqianc@colossus long_term_project]$cd sratoolkit.2.9.6-1-centos_linux64/
(base) [xinqianc@colossus sratoolkit.2.9.6-1-centos_linux64]$ cd bin (prefetch and fastq-dump is in bin file)
(base) [xinqianc@colossus bin]$  ./prefetch -v SRR2558111 (prefetch can only use under bin file and need to add ./ before)
(Troubleshooting: disk quota exceed) (Solution : https://ncgas.org/Blog_Posts/SRA%20toolkit.php; http://ncbi.github.io/sra-tools/install_config.html)
I still can not download SRR although I changed the environment to scratch....?????

(2)how to fix this problem: 
don't use prefetch(too large), use fastq-dump
(1)(command to change path: ./vdb-config -i)
change path to scratch/long_term_data ( because if I only change the path to scratch, it will pop up that this directory is not empty
. However, bin file is still in long_term_project.
(2)run : vdb-config --restore-defaults
(3)and then we could successfully run the sample fastq-dump file now
I have tried prefetch yet, because prefetch file is bigger, fastq-dump could also provide enough information.

(3)Download SRR file by ./fasterq-dump
(base) [xinqianc@colossus ~]$ cd scratch
(base) [xinqianc@colossus scratch]$ mkdir long_term_project
(base) [xinqianc@colossus scratch]$ cd long_term_project/
(base) [xinqianc@colossus long_term_project]$ cd sratoolkit.2.9.6-1-centos_linux64/
(base) [xinqianc@colossus sratoolkit.2.9.6-1-centos_linux64]$ cd bin/
(base) [xinqianc@colossus bin]$ ./fasterq-dump SRR2558138 -O ~/scratch/long_term_data (succeed)
./fasterq-dump SRR2558121 -O ~/scratch/long_term_data (failed) (maybe because its data size is larger than others
./fasterq-dump SRR2558138 -O ~/scratch/long_term_data (succeed)
./fasterq-dump SRR2558143 -O ~/scratch/long_term_data (succeed)
./fasterq-dump SRR2558142 -O ~/scratch/long_term_data (succeed)
./fasterq-dump SRR2558140 -O ~/scratch/long_term_data (succeed)
./fasterq-dump SRR2558152 -O ~/scratch/long_term_data (succeed)
(it doesn't work:./fastq-dump SRR2558138, get sra.cache file, not what I want )

(4) quality control of raw reads

(base) [xinqianc@colossus long_term_data]$ mkdir fastq
(base) [xinqianc@colossus long_term_data]$ ls
fastq  nannot  sra               SRR2558138.fastq  SRR2558142.fastq  SRR2558152.fastq
files  refseq  SRR2558121.fastq  SRR2558140.fastq  SRR2558143.fastq  wgs
(base) [xinqianc@colossus long_term_data]$ mv SRR2558138.fastq SRR2558142.fastq  SRR2558152.fastq  SRR2558121.fastq SRR2558140.fastq SRR2558143.fastq fastq

fastqc SRR2558121.fastq
SRR2558138.fastq
SRR2558142.fastq
SRR2558152.fastq
SRR2558140.fastq 
SRR2558143.fastq 


(5) skip cutadapt step: because I can't find the right adapters for it. I try several adapters and most of overepresented sequences percentile is increased.

(6)align reads to human transcriptomes by using bowtie2
human transcriptomes: ftp://ftp.ensembl.org/pub/release-74/fasta/homo_sapiens/cdna/Homo_sapiens.GRCh37.74.cdna.all.fa.gz


(base) [xinqianc@colossus long_term_data]$ mkdir RNASeq
(base) [xinqianc@colossus RNASeq]$ wget

(base) [xinqianc@colossus RNASeq]$ wget http://ftp.ensembl.org/pub/release-74/fasta/homo_sapiens/cdna/Homo_sapiens.GRCh37.74.cdna.all.fa.gz
(base) [xinqianc@colossus RNASeq]$ gunzip Homo_sapiens.GRCh37.74.cdna.all.fa.gz
(base) [xinqianc@colossus RNASeq]$ bowtie2-build Homo_sapiens.GRCh37.74.cdna.all.fa.gz Homo_sapiens

use Winscp to move SRR file from fastq to RNASeq directly.

(base) [xinqianc@colossus RNASeq]$ bowtie2 -x Homo_sapiens SRR2558140.fastq -S Alignment140.sam



















